<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>TourneyHub Pro | Advanced Gaming Dashboard</title>
    <meta name="description" content="Advanced gaming tournament dashboard with real-time stats, wallet management, and tournament tracking">
    <meta name="theme-color" content="#0f0f23">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <style>
    /* ============================================
       ADVANCED GAMING DASHBOARD CSS - KILLER STYLES
       Features: Neon Gaming Theme, Glass Morphism
       Performance Optimized, Mobile-First
    ============================================ */
    
    :root {
        /* Gaming Color Palette */
        --neon-blue: #00f3ff;
        --neon-purple: #b967ff;
        --neon-pink: #ff2d95;
        --neon-green: #00ff9d;
        --neon-orange: #ff7b00;
        
        /* Background Colors */
        --bg-dark: #0a0a14;
        --bg-darker: #050510;
        --bg-surface: rgba(20, 20, 40, 0.8);
        --bg-glass: rgba(255, 255, 255, 0.05);
        
        /* Text Colors */
        --text-primary: #ffffff;
        --text-secondary: #a0a0d0;
        --text-accent: #ffcc00;
        
        /* Effects */
        --glow-blue: 0 0 20px rgba(0, 243, 255, 0.5);
        --glow-purple: 0 0 20px rgba(185, 103, 255, 0.5);
        --glow-pink: 0 0 20px rgba(255, 45, 149, 0.5);
        --neon-glow: 0 0 30px currentColor;
        
        /* Animations */
        --transition-fast: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        --transition-smooth: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --transition-bounce: 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
    }
    
    html {
        font-size: 16px;
        scroll-behavior: smooth;
        height: 100%;
        background: var(--bg-darker);
    }
    
    body {
        font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
        background: linear-gradient(135deg, var(--bg-darker) 0%, #0a0a20 50%, #151530 100%);
        color: var(--text-primary);
        min-height: 100vh;
        overflow-x: hidden;
        position: relative;
        line-height: 1.6;
    }
    
    /* Cyberpunk Scanlines Effect */
    body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
            to bottom,
            transparent 50%,
            rgba(0, 243, 255, 0.03) 50%
        );
        background-size: 100% 4px;
        pointer-events: none;
        z-index: 9999;
        opacity: 0.3;
    }
    
    /* Loading Screen */
    .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--bg-darker);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    
    .loading-screen.hidden {
        opacity: 0;
        visibility: hidden;
    }
    
    .loader {
        text-align: center;
    }
    
    .loader-logo {
        width: 100px;
        height: 100px;
        background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 30px;
        animation: pulse 2s infinite;
        box-shadow: var(--glow-blue);
    }
    
    .loader-logo i {
        font-size: 48px;
        color: white;
    }
    
    .progress-bar {
        width: 200px;
        height: 4px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 2px;
        overflow: hidden;
        margin: 20px auto;
    }
    
    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
        width: 0%;
        transition: width 0.3s ease;
        border-radius: 2px;
    }
    
    /* Dashboard Container */
    .dashboard-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
        opacity: 0;
        animation: fadeIn 0.5s ease 0.3s forwards;
    }
    
    /* Header */
    .dashboard-header {
        background: rgba(20, 20, 40, 0.8);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(0, 243, 255, 0.2);
        padding: 15px 0;
        margin-bottom: 30px;
        position: sticky;
        top: 0;
        z-index: 100;
        border-radius: 15px;
        margin: 20px;
    }
    
    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 20px;
    }
    
    .logo {
        display: flex;
        align-items: center;
        gap: 15px;
    }
    
    .logo-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: var(--glow-blue);
    }
    
    .logo-text {
        font-size: 24px;
        font-weight: 900;
        background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .user-info {
        display: flex;
        align-items: center;
        gap: 15px;
    }
    
    .user-avatar {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        border: 2px solid var(--neon-blue);
        overflow: hidden;
        position: relative;
        box-shadow: var(--glow-blue);
    }
    
    .user-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .user-status {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 12px;
        height: 12px;
        background: var(--neon-green);
        border-radius: 50%;
        border: 2px solid var(--bg-dark);
    }
    
    /* Stats Grid */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 30px 20px;
    }
    
    .stat-card {
        background: linear-gradient(135deg, rgba(20, 20, 40, 0.8), rgba(30, 30, 60, 0.8));
        border: 1px solid rgba(0, 243, 255, 0.2);
        border-radius: 15px;
        padding: 25px;
        position: relative;
        overflow: hidden;
        transition: all var(--transition-smooth);
        backdrop-filter: blur(10px);
    }
    
    .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(0, 243, 255, 0.1), transparent);
        transition: left 0.6s ease;
    }
    
    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--glow-blue);
        border-color: var(--neon-blue);
    }
    
    .stat-card:hover::before {
        left: 100%;
    }
    
    .stat-icon {
        width: 60px;
        height: 60px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
        font-size: 24px;
        background: rgba(0, 243, 255, 0.1);
        color: var(--neon-blue);
    }
    
    .stat-number {
        font-size: 36px;
        font-weight: 800;
        margin-bottom: 10px;
        background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .stat-label {
        color: var(--text-secondary);
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    /* Quick Actions */
    .quick-actions {
        margin: 30px 20px;
    }
    
    .actions-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-top: 20px;
    }
    
    .action-btn {
        background: rgba(20, 20, 40, 0.8);
        border: 1px solid rgba(0, 243, 255, 0.2);
        border-radius: 12px;
        padding: 25px 15px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
        cursor: pointer;
        transition: all var(--transition-smooth);
        text-decoration: none;
        color: inherit;
        backdrop-filter: blur(10px);
    }
    
    .action-btn:hover {
        transform: translateY(-5px);
        border-color: var(--neon-purple);
        box-shadow: var(--glow-purple);
        background: rgba(185, 103, 255, 0.1);
    }
    
    .action-icon {
        width: 50px;
        height: 50px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        background: rgba(185, 103, 255, 0.1);
        color: var(--neon-purple);
    }
    
    /* Tab Navigation */
    .tabs-container {
        margin: 40px 20px;
        background: rgba(20, 20, 40, 0.8);
        border-radius: 15px;
        padding: 5px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(0, 243, 255, 0.1);
    }
    
    .tabs {
        display: flex;
        gap: 5px;
        position: relative;
    }
    
    .tab {
        flex: 1;
        padding: 20px;
        background: transparent;
        border: none;
        color: var(--text-secondary);
        font-weight: 600;
        cursor: pointer;
        transition: all var(--transition-smooth);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        position: relative;
        overflow: hidden;
    }
    
    .tab.active {
        background: rgba(0, 243, 255, 0.1);
        color: var(--neon-blue);
        box-shadow: inset 0 0 20px rgba(0, 243, 255, 0.1);
    }
    
    .tab.active::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 3px;
        background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
        border-radius: 0 0 12px 12px;
    }
    
    .tab-content {
        display: none;
        padding: 30px;
        animation: fadeIn 0.3s ease;
    }
    
    .tab-content.active {
        display: block;
    }
    
    /* Tournament Cards */
    .tournament-card {
        background: rgba(20, 20, 40, 0.8);
        border: 1px solid rgba(0, 243, 255, 0.2);
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 20px;
        transition: all var(--transition-smooth);
        backdrop-filter: blur(10px);
        position: relative;
        overflow: hidden;
    }
    
    .tournament-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 4px;
        height: 100%;
        background: linear-gradient(180deg, var(--neon-blue), var(--neon-purple));
    }
    
    .tournament-card:hover {
        transform: translateX(5px);
        border-color: var(--neon-blue);
        box-shadow: var(--glow-blue);
    }
    
    .tournament-status {
        display: inline-block;
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 15px;
    }
    
    .status-live {
        background: rgba(255, 45, 85, 0.2);
        color: #ff2d55;
        border: 1px solid rgba(255, 45, 85, 0.3);
        animation: pulse 1.5s infinite;
    }
    
    .status-upcoming {
        background: rgba(255, 204, 0, 0.2);
        color: #ffcc00;
        border: 1px solid rgba(255, 204, 0, 0.3);
    }
    
    .status-completed {
        background: rgba(0, 255, 157, 0.2);
        color: #00ff9d;
        border: 1px solid rgba(0, 255, 157, 0.3);
    }
    
    /* Match Cards */
    .match-card {
        background: rgba(20, 20, 40, 0.8);
        border: 1px solid rgba(185, 103, 255, 0.2);
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 20px;
        transition: all var(--transition-smooth);
        backdrop-filter: blur(10px);
    }
    
    .match-card:hover {
        transform: translateY(-3px);
        border-color: var(--neon-purple);
        box-shadow: var(--glow-purple);
    }
    
    .teams {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin: 20px 0;
    }
    
    .team {
        text-align: center;
        flex: 1;
    }
    
    .team-logo {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
        margin: 0 auto 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        font-weight: 700;
        color: white;
    }
    
    .vs {
        padding: 0 20px;
        font-weight: 900;
        font-size: 24px;
        color: var(--neon-pink);
        text-shadow: var(--glow-pink);
    }
    
    /* Wallet Card */
    .wallet-card {
        background: linear-gradient(135deg, rgba(20, 20, 40, 0.8), rgba(30, 30, 60, 0.8));
        border: 1px solid rgba(255, 204, 0, 0.2);
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 30px;
        text-align: center;
        backdrop-filter: blur(10px);
    }
    
    .balance {
        font-size: 48px;
        font-weight: 900;
        margin: 20px 0;
        background: linear-gradient(135deg, #ffcc00, #ff7b00);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 0 30px rgba(255, 204, 0, 0.3);
    }
    
    /* Profile Card */
    .profile-card {
        background: rgba(20, 20, 40, 0.8);
        border: 1px solid rgba(0, 243, 255, 0.2);
        border-radius: 15px;
        padding: 30px;
        text-align: center;
        backdrop-filter: blur(10px);
    }
    
    .profile-avatar {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        border: 4px solid var(--neon-blue);
        margin: 0 auto 20px;
        overflow: hidden;
        box-shadow: var(--glow-blue);
    }
    
    .profile-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    /* Notifications */
    .notification-toast {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(20, 20, 40, 0.95);
        border-left: 4px solid var(--neon-blue);
        border-radius: 10px;
        padding: 20px;
        display: none;
        align-items: center;
        gap: 15px;
        max-width: 350px;
        z-index: 1000;
        backdrop-filter: blur(20px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        animation: slideIn 0.3s ease;
    }
    
    .notification-toast.show {
        display: flex;
    }
    
    /* Bottom Navigation */
    .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background: rgba(20, 20, 40, 0.95);
        backdrop-filter: blur(20px);
        border-top: 1px solid rgba(0, 243, 255, 0.2);
        display: flex;
        justify-content: space-around;
        padding: 15px 0;
        z-index: 100;
        display: none;
    }
    
    .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 5px;
        color: var(--text-secondary);
        text-decoration: none;
        transition: all var(--transition-smooth);
        padding: 10px;
        border-radius: 10px;
    }
    
    .nav-item.active {
        color: var(--neon-blue);
        background: rgba(0, 243, 255, 0.1);
    }
    
    .nav-item i {
        font-size: 20px;
    }
    
    /* FAB */
    .fab {
        position: fixed;
        bottom: 90px;
        right: 20px;
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        cursor: pointer;
        box-shadow: var(--glow-blue);
        transition: all var(--transition-smooth);
        z-index: 99;
        display: none;
    }
    
    .fab:hover {
        transform: scale(1.1) rotate(90deg);
        box-shadow: 0 0 40px rgba(0, 243, 255, 0.6);
    }
    
    /* Animations */
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
    }
    
    @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes neonGlow {
        0%, 100% { text-shadow: 0 0 10px currentColor, 0 0 20px currentColor; }
        50% { text-shadow: 0 0 20px currentColor, 0 0 40px currentColor, 0 0 60px currentColor; }
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
        .dashboard-header {
            margin: 10px;
            border-radius: 10px;
        }
        
        .stats-grid {
            grid-template-columns: 1fr;
            margin: 20px 10px;
        }
        
        .actions-grid {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .tabs-container {
            margin: 20px 10px;
        }
        
        .tab {
            padding: 15px 10px;
            font-size: 14px;
        }
        
        .bottom-nav {
            display: flex;
        }
        
        .fab {
            display: flex;
        }
        
        .user-info .user-name {
            display: none;
        }
        
        .logo-text {
            font-size: 20px;
        }
    }
    
    @media (max-width: 480px) {
        .dashboard-container {
            padding: 10px;
        }
        
        .actions-grid {
            grid-template-columns: 1fr;
        }
        
        .tab {
            font-size: 12px;
        }
        
        .balance {
            font-size: 36px;
        }
    }
    
    /* Utility Classes */
    .neon-text {
        animation: neonGlow 2s infinite;
    }
    
    .glass-effect {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .cyber-border {
        position: relative;
        overflow: hidden;
    }
    
    .cyber-border::after {
        content: '';
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        background: linear-gradient(45deg, var(--neon-blue), var(--neon-purple), var(--neon-pink), var(--neon-green));
        border-radius: inherit;
        z-index: -1;
        animation: rotate 3s linear infinite;
    }
    
    @keyframes rotate {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    /* Custom Scrollbar */
    ::-webkit-scrollbar {
        width: 10px;
    }
    
    ::-webkit-scrollbar-track {
        background: rgba(20, 20, 40, 0.8);
        border-radius: 5px;
    }
    
    ::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, var(--neon-blue), var(--neon-purple));
        border-radius: 5px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, var(--neon-purple), var(--neon-pink));
    }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loader">
            <div class="loader-logo">
                <i class="fas fa-gamepad"></i>
            </div>
            <h2 style="margin-bottom: 20px; color: var(--neon-blue);">TOURNEYHUB PRO</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="loadingProgress"></div>
            </div>
            <p style="color: var(--text-secondary); margin-top: 10px;">Initializing gaming arena...</p>
        </div>
    </div>

    <!-- Dashboard Container -->
    <div class="dashboard-container">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <h1 class="logo-text">TOURNEYHUB</h1>
                </div>
                
                <div class="user-info">
                    <div class="user-avatar">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=gamer&backgroundColor=00f3ff&hair=short" alt="Avatar">
                        <div class="user-status"></div>
                    </div>
                    <span class="user-name">CyberGamer</span>
                    <button id="logoutBtn" class="btn-logout" style="background: none; border: 1px solid var(--neon-pink); color: var(--neon-pink); padding: 8px 15px; border-radius: 20px; cursor: pointer; transition: all 0.3s;">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-trophy"></i>
                </div>
                <div class="stat-number" id="tournamentsWon">0</div>
                <div class="stat-label">Tournaments Won</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-gamepad"></i>
                </div>
                <div class="stat-number" id="matchesPlayed">0</div>
                <div class="stat-label">Matches Played</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="stat-number" id="winRate">0%</div>
                <div class="stat-label">Win Rate</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-coins"></i>
                </div>
                <div class="stat-number" id="walletBalance">₮0</div>
                <div class="stat-label">Wallet Balance</div>
            </div>
        </div>

        <!-- Quick Actions -->
        <section class="quick-actions">
            <h2 style="margin-bottom: 20px; color: var(--text-primary); font-size: 24px;">
                <i class="fas fa-bolt" style="color: var(--neon-green); margin-right: 10px;"></i>
                Quick Actions
            </h2>
            <div class="actions-grid">
                <a href="#" class="action-btn" id="joinTournament">
                    <div class="action-icon">
                        <i class="fas fa-plus"></i>
                    </div>
                    <span>Join Tournament</span>
                </a>
                
                <a href="#" class="action-btn" id="addFunds">
                    <div class="action-icon">
                        <i class="fas fa-wallet"></i>
                    </div>
                    <span>Add Funds</span>
                </a>
                
                <a href="#" class="action-btn" id="createTeam">
                    <div class="action-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <span>Create Team</span>
                </a>
                
                <a href="#" class="action-btn" id="viewLeaderboard">
                    <div class="action-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <span>Leaderboard</span>
                </a>
            </div>
        </section>

        <!-- Tab Navigation -->
        <div class="tabs-container">
            <div class="tabs">
                <button class="tab active" data-tab="tournaments">
                    <i class="fas fa-trophy"></i>
                    Tournaments
                </button>
                <button class="tab" data-tab="matches">
                    <i class="fas fa-crosshairs"></i>
                    Matches
                </button>
                <button class="tab" data-tab="wallet">
                    <i class="fas fa-wallet"></i>
                    Wallet
                </button>
                <button class="tab" data-tab="profile">
                    <i class="fas fa-user"></i>
                    Profile
                </button>
            </div>
            
            <!-- Tab Content -->
            <div class="tab-content active" id="tournaments-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="color: var(--neon-blue);">Active Tournaments</h2>
                    <button id="refreshTournaments" style="background: rgba(0, 243, 255, 0.1); border: 1px solid var(--neon-blue); color: var(--neon-blue); padding: 8px 15px; border-radius: 20px; cursor: pointer; font-size: 14px; display: flex; align-items: center; gap: 5px;">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
                <div id="tournamentsList">
                    <!-- Dynamic content will be loaded here -->
                </div>
            </div>
            
            <div class="tab-content" id="matches-content">
                <h2 style="margin-bottom: 20px; color: var(--neon-purple);">Recent Matches</h2>
                <div id="matchesList">
                    <!-- Dynamic content will be loaded here -->
                </div>
            </div>
            
            <div class="tab-content" id="wallet-content">
                <div class="wallet-card">
                    <h2 style="color: var(--text-secondary);">Wallet Balance</h2>
                    <div class="balance" id="currentBalance">₮0</div>
                    <div style="display: flex; gap: 15px; justify-content: center; margin-top: 30px;">
                        <button id="depositBtn" style="background: linear-gradient(135deg, var(--neon-green), #00cc7a); border: none; padding: 12px 25px; border-radius: 25px; color: white; font-weight: 600; cursor: pointer; transition: transform 0.3s;">
                            <i class="fas fa-arrow-down"></i> Deposit
                        </button>
                        <button id="withdrawBtn" style="background: rgba(255, 255, 255, 0.1); border: 1px solid var(--neon-blue); padding: 12px 25px; border-radius: 25px; color: var(--neon-blue); font-weight: 600; cursor: pointer; transition: all 0.3s;">
                            <i class="fas fa-arrow-up"></i> Withdraw
                        </button>
                    </div>
                </div>
                
                <h3 style="margin: 30px 0 20px; color: var(--text-primary);">Recent Transactions</h3>
                <div id="transactionsList">
                    <!-- Dynamic content will be loaded here -->
                </div>
            </div>
            
            <div class="tab-content" id="profile-content">
                <div class="profile-card">
                    <div class="profile-avatar">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=gamer&backgroundColor=00f3ff&hair=short" alt="Profile">
                    </div>
                    <h2 style="margin-bottom: 10px; color: var(--text-primary);" id="profileName">CyberGamer</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;" id="profileEmail">gamer@tourneyhub.com</p>
                    
                    <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 30px;">
                        <span style="background: rgba(0, 243, 255, 0.2); color: var(--neon-blue); padding: 5px 15px; border-radius: 20px; font-size: 12px;">
                            <i class="fas fa-check"></i> Verified
                        </span>
                        <span style="background: rgba(255, 204, 0, 0.2); color: #ffcc00; padding: 5px 15px; border-radius: 20px; font-size: 12px;">
                            <i class="fas fa-crown"></i> Pro
                        </span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 30px;">
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 800; color: var(--neon-blue);">Lvl 42</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Level</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 800; color: var(--neon-purple);">#87</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Rank</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 800; color: var(--neon-green);">328h</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Play Time</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation (Mobile) -->
    <nav class="bottom-nav">
        <a href="#" class="nav-item active" data-tab="tournaments">
            <i class="fas fa-trophy"></i>
            <span>Tourneys</span>
        </a>
        <a href="#" class="nav-item" data-tab="matches">
            <i class="fas fa-crosshairs"></i>
            <span>Matches</span>
        </a>
        <a href="#" class="nav-item" data-tab="wallet">
            <i class="fas fa-wallet"></i>
            <span>Wallet</span>
        </a>
        <a href="#" class="nav-item" data-tab="profile">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </a>
    </nav>

    <!-- FAB -->
    <div class="fab" id="fabButton">
        <i class="fas fa-plus"></i>
    </div>

    <!-- Notification Toast -->
    <div id="notificationToast" class="notification-toast">
        <div style="width: 40px; height: 40px; border-radius: 10px; background: rgba(0, 243, 255, 0.1); display: flex; align-items: center; justify-content: center; color: var(--neon-blue); font-size: 20px;">
            <i class="fas fa-info-circle"></i>
        </div>
        <div>
            <div id="toastTitle" style="font-weight: 600; margin-bottom: 5px;">Notification</div>
            <div id="toastMessage" style="font-size: 14px; color: var(--text-secondary);">Welcome to TourneyHub Pro!</div>
        </div>
        <button id="toastClose" style="background: none; border: none; color: var(--text-secondary); font-size: 20px; cursor: pointer; margin-left: auto;">×</button>
    </div>

    <!-- Advanced JavaScript -->
    <script>
    // ============================================
    // ADVANCED GAMING DASHBOARD JS
    // Features: Real-time updates, Firebase integration
    // Performance optimized, Error handling
    // ============================================
    
    class GamingDashboard {
        constructor() {
            this.state = {
                user: null,
                stats: {
                    tournamentsWon: 8,
                    matchesPlayed: 42,
                    winRate: 67,
                    walletBalance: 1240
                },
                activeTab: 'tournaments',
                tournaments: [],
                matches: [],
                transactions: [],
                isLoading: true
            };
            
            this.firebaseConfig = {
                apiKey: "AIzaSyA7QsyV2yb4f_acY9ETQnTSna7YHxwOJw4",
                authDomain: "authapp-386ee.firebaseapp.com",
                projectId: "authapp-386ee",
                storageBucket: "authapp-386ee.firebasestorage.app",
                messagingSenderId: "809698525310",
                appId: "1:809698525310:web:5cb7de80bde9ed1f26982f"
            };
            
            this.init();
        }
        
        async init() {
            try {
                // Initialize Firebase
                if (!firebase.apps.length) {
                    firebase.initializeApp(this.firebaseConfig);
                }
                
                this.auth = firebase.auth();
                this.db = firebase.firestore();
                
                // Enable offline persistence
                await this.db.enablePersistence().catch(err => {
                    console.warn("Offline persistence failed:", err);
                });
                
                // Check auth state
                this.auth.onAuthStateChanged(async (user) => {
                    if (user) {
                        this.state.user = user;
                        await this.loadUserData();
                    } else {
                        // Demo mode - use mock data
                        this.loadMockData();
                    }
                    
                    this.initUI();
                    this.setupEventListeners();
                    this.simulateLoading();
                });
                
            } catch (error) {
                console.error("Initialization error:", error);
                this.loadMockData();
                this.initUI();
                this.setupEventListeners();
                this.simulateLoading();
            }
        }
        
        async loadUserData() {
            try {
                if (!this.state.user) return;
                
                const userDoc = await this.db.collection('users').doc(this.state.user.uid).get();
                
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    this.state.stats = userData.stats || this.state.stats;
                }
                
                // Load tournaments from Firebase
                await this.loadTournamentsFromFirebase();
                
                // Load matches
                await this.loadMatches();
                
                // Load transactions
                await this.loadTransactions();
                
            } catch (error) {
                console.error("Error loading user data:", error);
                this.loadMockData();
            }
        }
        
        async loadTournamentsFromFirebase() {
            try {
                console.log("Loading tournaments from Firebase...");
                
                if (!this.db) {
                    console.log("Firebase not available, using mock data");
                    this.loadMockTournaments();
                    return;
                }
                
                // Try to get tournaments from Firebase Firestore
                const tournamentsRef = this.db.collection('tournaments');
                const snapshot = await tournamentsRef
                    .where('status', 'in', ['live', 'upcoming'])
                    .orderBy('startDate', 'asc')
                    .limit(10)
                    .get();
                
                if (snapshot.empty) {
                    console.log("No tournaments found in Firebase, creating sample data...");
                    await this.createSampleTournaments();
                    return;
                }
                
                console.log(`Found ${snapshot.size} tournaments from Firebase`);
                
                this.state.tournaments = [];
                snapshot.forEach(doc => {
                    const data = doc.data();
                    this.state.tournaments.push({
                        id: doc.id,
                        title: data.title || 'Untitled Tournament',
                        game: data.game || 'Unknown Game',
                        status: data.status || 'upcoming',
                        prize: data.prize || 0,
                        entryFee: data.entryFee || 0,
                        currentPlayers: data.currentPlayers || 0,
                        maxPlayers: data.maxPlayers || 0,
                        startDate: data.startDate ? data.startDate.toDate() : new Date(),
                        description: data.description || '',
                        organizer: data.organizer || 'TourneyHub',
                        rules: data.rules || '',
                        platform: data.platform || 'PC'
                    });
                });
                
                this.renderTournaments();
                this.showNotification("Tournaments Loaded", `Loaded ${this.state.tournaments.length} tournaments from Firebase`, "success");
                
            } catch (error) {
                console.error("Error loading tournaments from Firebase:", error);
                this.showNotification("Firebase Error", "Using mock tournament data", "warning");
                this.loadMockTournaments();
            }
        }
        
        async createSampleTournaments() {
            try {
                if (!this.db) return;
                
                const sampleTournaments = [
                    {
                        title: "Valorant Pro Series",
                        game: "Valorant",
                        status: "live",
                        prize: 5000,
                        entryFee: 150,
                        currentPlayers: 12,
                        maxPlayers: 16,
                        startDate: firebase.firestore.Timestamp.fromDate(new Date(Date.now() - 3600000)),
                        description: "Join the ultimate Valorant competition! Show your skills and win big!",
                        organizer: "TourneyHub",
                        rules: "5v5, Single Elimination, Best of 3",
                        platform: "PC",
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    },
                    {
                        title: "CS:GO Championship",
                        game: "CS:GO",
                        status: "upcoming",
                        prize: 10000,
                        entryFee: 200,
                        currentPlayers: 8,
                        maxPlayers: 16,
                        startDate: firebase.firestore.Timestamp.fromDate(new Date(Date.now() + 7200000)),
                        description: "Compete in the CS:GO championship for a massive prize pool!",
                        organizer: "TourneyHub",
                        rules: "5v5, Swiss Format, Best of 3",
                        platform: "PC",
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    },
                    {
                        title: "Fortnite Weekly",
                        game: "Fortnite",
                        status: "upcoming",
                        prize: 2500,
                        entryFee: 100,
                        currentPlayers: 50,
                        maxPlayers: 100,
                        startDate: firebase.firestore.Timestamp.fromDate(new Date(Date.now() + 86400000)),
                        description: "Weekly Fortnite tournament open to all players!",
                        organizer: "TourneyHub",
                        rules: "Solo, Battle Royale, 3 Matches",
                        platform: "Cross-Platform",
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    },
                    {
                        title: "Dota 2 Masters",
                        game: "Dota 2",
                        status: "live",
                        prize: 15000,
                        entryFee: 300,
                        currentPlayers: 10,
                        maxPlayers: 16,
                        startDate: firebase.firestore.Timestamp.fromDate(new Date(Date.now() - 1800000)),
                        description: "Professional Dota 2 tournament with massive prize pool",
                        organizer: "TourneyHub",
                        rules: "5v5, Captain's Mode, Best of 3",
                        platform: "PC",
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    },
                    {
                        title: "Apex Legends Showdown",
                        game: "Apex Legends",
                        status: "upcoming",
                        prize: 7500,
                        entryFee: 120,
                        currentPlayers: 30,
                        maxPlayers: 60,
                        startDate: firebase.firestore.Timestamp.fromDate(new Date(Date.now() + 172800000)),
                        description: "Team up and dominate in Apex Legends!",
                        organizer: "TourneyHub",
                        rules: "3v3, Battle Royale, 5 Matches",
                        platform: "Cross-Platform",
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    }
                ];
                
                // Add sample tournaments to Firestore
                const batch = this.db.batch();
                sampleTournaments.forEach(tournament => {
                    const docRef = this.db.collection('tournaments').doc();
                    batch.set(docRef, tournament);
                });
                
                await batch.commit();
                console.log("Sample tournaments created successfully");
                
                // Reload tournaments
                await this.loadTournamentsFromFirebase();
                
            } catch (error) {
                console.error("Error creating sample tournaments:", error);
                this.loadMockTournaments();
            }
        }
        
        async loadMatches() {
            try {
                if (!this.db) {
                    this.state.matches = this.getMockMatches();
                    this.renderMatches();
                    return;
                }
                
                // Try to get matches from Firebase
                const matchesRef = this.db.collection('matches');
                const snapshot = await matchesRef
                    .where('userId', '==', this.state.user?.uid || 'demo')
                    .orderBy('date', 'desc')
                    .limit(5)
                    .get();
                
                if (!snapshot.empty) {
                    this.state.matches = [];
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        this.state.matches.push({
                            id: doc.id,
                            ...data
                        });
                    });
                } else {
                    this.state.matches = this.getMockMatches();
                }
                
                this.renderMatches();
                
            } catch (error) {
                console.error("Error loading matches:", error);
                this.state.matches = this.getMockMatches();
                this.renderMatches();
            }
        }
        
        async loadTransactions() {
            try {
                this.state.transactions = this.getMockTransactions();
                this.renderTransactions();
                
            } catch (error) {
                console.error("Error loading transactions:", error);
                this.state.transactions = this.getMockTransactions();
                this.renderTransactions();
            }
        }
        
        loadMockTournaments() {
            this.state.tournaments = [
                {
                    id: 1,
                    title: "Valorant Pro Series",
                    game: "Valorant",
                    status: "live",
                    prize: 5000,
                    entryFee: 150,
                    currentPlayers: 12,
                    maxPlayers: 16,
                    startDate: new Date(Date.now() - 3600000),
                    description: "Join the ultimate Valorant competition!",
                    organizer: "TourneyHub",
                    rules: "5v5, Single Elimination",
                    platform: "PC"
                },
                {
                    id: 2,
                    title: "CS:GO Championship",
                    game: "CS:GO",
                    status: "upcoming",
                    prize: 10000,
                    entryFee: 200,
                    currentPlayers: 8,
                    maxPlayers: 16,
                    startDate: new Date(Date.now() + 7200000),
                    description: "Compete in the CS:GO championship!",
                    organizer: "TourneyHub",
                    rules: "5v5, Swiss Format",
                    platform: "PC"
                },
                {
                    id: 3,
                    title: "Fortnite Weekly",
                    game: "Fortnite",
                    status: "upcoming",
                    prize: 2500,
                    entryFee: 100,
                    currentPlayers: 50,
                    maxPlayers: 100,
                    startDate: new Date(Date.now() + 86400000),
                    description: "Weekly Fortnite tournament!",
                    organizer: "TourneyHub",
                    rules: "Solo, Battle Royale",
                    platform: "Cross-Platform"
                }
            ];
            
            this.renderTournaments();
        }
        
        getMockMatches() {
            return [
                {
                    id: 1,
                    team1: { name: "Your Team", score: 2, logo: "YT" },
                    team2: { name: "Vortex", score: 1, logo: "VX" },
                    status: "completed",
                    tournament: "Valorant Pro Series",
                    date: "2 hours ago"
                },
                {
                    id: 2,
                    team1: { name: "Your Team", score: 0, logo: "YT" },
                    team2: { name: "Phoenix", score: 0, logo: "PH" },
                    status: "upcoming",
                    tournament: "CS:GO Championship",
                    date: "In 45 min"
                }
            ];
        }
        
        getMockTransactions() {
            return [
                { id: 1, type: 'deposit', amount: 750, description: 'Tournament Win', date: '2 hours ago', status: 'completed' },
                { id: 2, type: 'withdrawal', amount: 200, description: 'Withdrawal', date: '1 day ago', status: 'completed' },
                { id: 3, type: 'deposit', amount: 500, description: 'Deposit', date: '3 days ago', status: 'completed' }
            ];
        }
        
        loadMockData() {
            this.loadMockTournaments();
            this.loadMatches();
            this.loadTransactions();
        }
        
        simulateLoading() {
            let progress = 0;
            const progressBar = document.getElementById('loadingProgress');
            const loadingScreen = document.getElementById('loadingScreen');
            
            const interval = setInterval(() => {
                progress += 10;
                if (progressBar) progressBar.style.width = `${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        if (loadingScreen) {
                            loadingScreen.classList.add('hidden');
                        }
                        
                        this.showNotification("Welcome to TourneyHub Pro!", "Your gaming dashboard is ready!", "success");
                        
                        this.updateStats();
                        
                    }, 500);
                }
            }, 150);
        }
        
        initUI() {
            this.initTabs();
            this.updateUserInfo();
            this.checkMobile();
            window.addEventListener('resize', () => this.checkMobile());
        }
        
        initTabs() {
            const tabs = document.querySelectorAll('.tab');
            const navItems = document.querySelectorAll('.nav-item');
            
            const switchTab = (tabId) => {
                this.state.activeTab = tabId;
                
                tabs.forEach(tab => {
                    tab.classList.toggle('active', tab.dataset.tab === tabId);
                });
                
                navItems.forEach(item => {
                    item.classList.toggle('active', item.dataset.tab === tabId);
                });
                
                const contents = document.querySelectorAll('.tab-content');
                contents.forEach(content => {
                    content.classList.toggle('active', content.id === `${tabId}-content`);
                });
                
                switch(tabId) {
                    case 'tournaments':
                        if (this.state.tournaments.length === 0) this.loadTournamentsFromFirebase();
                        break;
                    case 'matches':
                        if (this.state.matches.length === 0) this.loadMatches();
                        break;
                    case 'wallet':
                        if (this.state.transactions.length === 0) this.loadTransactions();
                        break;
                }
            };
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab.dataset.tab));
            });
            
            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    switchTab(item.dataset.tab);
                });
            });
            
            switchTab(this.state.activeTab);
        }
        
        updateStats() {
            document.getElementById('tournamentsWon').textContent = this.state.stats.tournamentsWon;
            document.getElementById('matchesPlayed').textContent = this.state.stats.matchesPlayed;
            document.getElementById('winRate').textContent = `${this.state.stats.winRate}%`;
            document.getElementById('walletBalance').textContent = `₮${this.state.stats.walletBalance}`;
            document.getElementById('currentBalance').textContent = `₮${this.state.stats.walletBalance}`;
        }
        
        updateUserInfo() {
            if (this.state.user) {
                document.getElementById('profileName').textContent = this.state.user.displayName || 'CyberGamer';
                document.getElementById('profileEmail').textContent = this.state.user.email || 'gamer@tourneyhub.com';
            }
        }
        
        renderTournaments() {
            const container = document.getElementById('tournamentsList');
            if (!container) return;
            
            if (this.state.tournaments.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        <i class="fas fa-trophy" style="font-size: 48px; margin-bottom: 20px; opacity: 0.5;"></i>
                        <h3>No Tournaments Found</h3>
                        <p>Check back soon for new tournaments!</p>
                        <button id="createTournamentBtn" style="margin-top: 20px; background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple)); border: none; padding: 10px 20px; border-radius: 20px; color: white; font-weight: 600; cursor: pointer;">
                            Create Tournament
                        </button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = this.state.tournaments.map(tournament => {
                const playersText = `${tournament.currentPlayers}/${tournament.maxPlayers}`;
                const timeText = this.getTournamentTimeText(tournament);
                const statusClass = tournament.status === 'live' ? 'status-live' : 
                                  tournament.status === 'upcoming' ? 'status-upcoming' : 'status-completed';
                
                return `
                <div class="tournament-card">
                    <div class="tournament-status ${statusClass}">${tournament.status.toUpperCase()}</div>
                    <h3 style="margin-bottom: 10px; color: var(--text-primary);">${tournament.title}</h3>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <span style="color: var(--text-secondary);">
                            <i class="fas fa-gamepad" style="margin-right: 8px;"></i>${tournament.game}
                        </span>
                        <span style="color: var(--neon-green); font-weight: 600;">₮${tournament.prize.toLocaleString()}</span>
                    </div>
                    
                    <div style="margin-bottom: 15px; color: var(--text-secondary); font-size: 14px;">
                        ${tournament.description}
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; color: var(--text-secondary); font-size: 14px; margin-bottom: 10px;">
                        <span><i class="fas fa-users" style="margin-right: 5px;"></i> ${playersText}</span>
                        <span><i class="fas fa-calendar" style="margin-right: 5px;"></i> ${this.formatDate(tournament.startDate)}</span>
                        <span><i class="fas fa-coins" style="margin-right: 5px;"></i> ₮${tournament.entryFee}</span>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; color: var(--text-secondary); font-size: 12px; margin-bottom: 20px;">
                        <span><i class="fas fa-user" style="margin-right: 5px;"></i> ${tournament.organizer}</span>
                        <span><i class="fas fa-desktop" style="margin-right: 5px;"></i> ${tournament.platform}</span>
                        <span><i class="fas fa-clock" style="margin-right: 5px;"></i> ${timeText}</span>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button class="tournament-action" data-id="${tournament.id}" style="flex: 1; background: rgba(0, 243, 255, 0.1); border: 1px solid var(--neon-blue); color: var(--neon-blue); padding: 10px; border-radius: 8px; cursor: pointer; transition: all 0.3s;">
                            ${tournament.status === 'live' ? 'Join Now' : tournament.status === 'upcoming' ? 'Register Now' : 'View Results'}
                        </button>
                        <button class="tournament-details" data-id="${tournament.id}" style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); color: var(--text-secondary); padding: 10px; border-radius: 8px; cursor: pointer; transition: all 0.3s;">
                            <i class="fas fa-info-circle"></i>
                        </button>
                        <button class="share-tournament" data-id="${tournament.id}" style="background: rgba(185, 103, 255, 0.1); border: 1px solid var(--neon-purple); color: var(--neon-purple); padding: 10px; border-radius: 8px; cursor: pointer; transition: all 0.3s;">
                            <i class="fas fa-share-alt"></i>
                        </button>
                    </div>
                </div>
                `;
            }).join('');
            
            container.querySelectorAll('.tournament-action').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const tournamentId = e.target.dataset.id;
                    this.handleTournamentAction(tournamentId);
                });
            });
            
            container.querySelectorAll('.tournament-details').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const tournamentId = e.target.closest('button').dataset.id;
                    this.viewTournamentDetails(tournamentId);
                });
            });
            
            container.querySelectorAll('.share-tournament').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const tournamentId = e.target.closest('button').dataset.id;
                    this.shareTournament(tournamentId);
                });
            });
        }
        
        getTournamentTimeText(tournament) {
            const now = new Date();
            const startDate = tournament.startDate instanceof Date ? tournament.startDate : new Date(tournament.startDate);
            
            if (tournament.status === 'live') {
                return 'Live Now';
            } else if (tournament.status === 'upcoming') {
                const diffMs = startDate - now;
                const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
                const diffDays = Math.floor(diffHours / 24);
                
                if (diffDays > 0) {
                    return `Starts in ${diffDays} day${diffDays > 1 ? 's' : ''}`;
                } else if (diffHours > 0) {
                    return `Starts in ${diffHours} hour${diffHours > 1 ? 's' : ''}`;
                } else {
                    return 'Starting soon';
                }
            } else {
                return 'Completed';
            }
        }
        
        formatDate(date) {
            if (!date) return 'N/A';
            const d = date instanceof Date ? date : new Date(date);
            return d.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        renderMatches() {
            const container = document.getElementById('matchesList');
            if (!container) return;
            
            if (this.state.matches.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        <i class="fas fa-crosshairs" style="font-size: 48px; margin-bottom: 20px; opacity: 0.5;"></i>
                        <h3>No Matches Yet</h3>
                        <p>Join a tournament to see your matches here</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = this.state.matches.map(match => `
                <div class="match-card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="color: var(--text-primary);">${match.tournament}</h3>
                        <span style="color: ${match.status === 'completed' ? 'var(--neon-green)' : 'var(--neon-orange)'}; font-size: 12px; font-weight: 600;">
                            ${match.status === 'completed' ? 'COMPLETED' : 'UPCOMING'}
                        </span>
                    </div>
                    
                    <div class="teams">
                        <div class="team">
                            <div class="team-logo" style="background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));">
                                ${match.team1.logo}
                            </div>
                            <div style="font-weight: 600; margin-bottom: 5px;">${match.team1.name}</div>
                            <div style="font-size: 24px; font-weight: 800; color: var(--neon-blue);">${match.team1.score}</div>
                        </div>
                        
                        <div class="vs">VS</div>
                        
                        <div class="team">
                            <div class="team-logo" style="background: linear-gradient(135deg, var(--neon-pink), #ff0055);">
                                ${match.team2.logo}
                            </div>
                            <div style="font-weight: 600; margin-bottom: 5px;">${match.team2.name}</div>
                            <div style="font-size: 24px; font-weight: 800; color: var(--neon-pink);">${match.team2.score}</div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; color: var(--text-secondary); margin-top: 20px; font-size: 14px;">
                        <i class="fas fa-clock" style="margin-right: 5px;"></i> ${match.date}
                    </div>
                    
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="view-match" data-id="${match.id}" style="background: rgba(185, 103, 255, 0.1); border: 1px solid var(--neon-purple); color: var(--neon-purple); padding: 10px 25px; border-radius: 20px; cursor: pointer; transition: all 0.3s;">
                            ${match.status === 'completed' ? 'View Stats' : 'Prepare'}
                        </button>
                    </div>
                </div>
            `).join('');
            
            container.querySelectorAll('.view-match').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const matchId = e.target.dataset.id;
                    this.viewMatchDetails(matchId);
                });
            });
        }
        
        renderTransactions() {
            const container = document.getElementById('transactionsList');
            if (!container) return;
            
            if (this.state.transactions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: var(--text-secondary);">
                        <i class="fas fa-exchange-alt" style="font-size: 32px; margin-bottom: 10px; opacity: 0.5;"></i>
                        <p>No transactions yet</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = this.state.transactions.map(transaction => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: rgba(255, 255, 255, 0.03); border-radius: 10px; margin-bottom: 10px; transition: all 0.3s; cursor: pointer;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="width: 40px; height: 40px; border-radius: 10px; background: ${transaction.type === 'deposit' ? 'rgba(0, 255, 157, 0.1)' : 'rgba(255, 45, 85, 0.1)'}; display: flex; align-items: center; justify-content: center; color: ${transaction.type === 'deposit' ? 'var(--neon-green)' : 'var(--neon-pink)'};">
                            <i class="fas fa-${transaction.type === 'deposit' ? 'arrow-down' : 'arrow-up'}"></i>
                        </div>
                        <div>
                            <div style="font-weight: 600; margin-bottom: 5px;">${transaction.description}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">${transaction.date}</div>
                        </div>
                    </div>
                    <div style="font-weight: 700; color: ${transaction.type === 'deposit' ? 'var(--neon-green)' : 'var(--neon-pink)'};">
                        ${transaction.type === 'deposit' ? '+' : '-'}₮${transaction.amount}
                    </div>
                </div>
            `).join('');
        }
        
        setupEventListeners() {
            document.getElementById('logoutBtn')?.addEventListener('click', () => this.logout());
            
            document.getElementById('joinTournament')?.addEventListener('click', (e) => {
                e.preventDefault();
                this.showNotification("Join Tournament", "Redirecting to tournaments page...", "info");
            });
            
            document.getElementById('addFunds')?.addEventListener('click', (e) => {
                e.preventDefault();
                this.switchTab('wallet');
                this.showNotification("Add Funds", "Opening deposit options...", "info");
            });
            
            document.getElementById('depositBtn')?.addEventListener('click', () => {
                this.showNotification("Deposit", "Select your payment method...", "info");
            });
            
            document.getElementById('withdrawBtn')?.addEventListener('click', () => {
                this.showNotification("Withdraw", "Enter withdrawal amount...", "info");
            });
            
            document.getElementById('refreshTournaments')?.addEventListener('click', () => {
                this.refreshTournaments();
            });
            
            document.getElementById('fabButton')?.addEventListener('click', () => {
                this.showNotification("Quick Action", "What would you like to do?", "info");
            });
            
            document.getElementById('toastClose')?.addEventListener('click', () => {
                this.hideNotification();
            });
            
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key === '1') {
                    e.preventDefault();
                    this.switchTab('tournaments');
                }
                if (e.ctrlKey && e.key === '2') {
                    e.preventDefault();
                    this.switchTab('matches');
                }
                if (e.ctrlKey && e.key === '3') {
                    e.preventDefault();
                    this.switchTab('wallet');
                }
                if (e.ctrlKey && e.key === '4') {
                    e.preventDefault();
                    this.switchTab('profile');
                }
                if (e.key === 'Escape') {
                    this.hideNotification();
                }
                if (e.key === 'F5' || (e.ctrlKey && e.key === 'r')) {
                    e.preventDefault();
                    this.refreshTournaments();
                }
            });
            
            window.addEventListener('online', () => {
                this.showNotification("You're back online!", "Syncing data...", "success");
                this.refreshTournaments();
            });
            
            window.addEventListener('offline', () => {
                this.showNotification("You're offline", "Some features may be limited", "warning");
            });
        }
        
        async refreshTournaments() {
            this.showNotification("Refreshing", "Loading tournaments from Firebase...", "info");
            await this.loadTournamentsFromFirebase();
        }
        
        switchTab(tabId) {
            this.state.activeTab = tabId;
            
            const tab = document.querySelector(`.tab[data-tab="${tabId}"]`);
            if (tab) tab.click();
            
            const navItem = document.querySelector(`.nav-item[data-tab="${tabId}"]`);
            if (navItem) navItem.click();
        }
        
        handleTournamentAction(tournamentId) {
            const tournament = this.state.tournaments.find(t => t.id == tournamentId);
            if (!tournament) return;
            
            if (tournament.status === 'live') {
                this.showNotification("Joining Tournament", `Entering ${tournament.title}...`, "success");
            } else if (tournament.status === 'upcoming') {
                this.showNotification("Registration", `Registering for ${tournament.title}...`, "info");
            } else {
                this.showNotification("Tournament Results", `Viewing results for ${tournament.title}`, "info");
            }
        }
        
        viewTournamentDetails(tournamentId) {
            const tournament = this.state.tournaments.find(t => t.id == tournamentId);
            if (!tournament) return;
            
            const details = `
                <strong>${tournament.title}</strong><br>
                <strong>Game:</strong> ${tournament.game}<br>
                <strong>Prize Pool:</strong> ₮${tournament.prize}<br>
                <strong>Entry Fee:</strong> ₮${tournament.entryFee}<br>
                <strong>Players:</strong> ${tournament.currentPlayers}/${tournament.maxPlayers}<br>
                <strong>Start:</strong> ${this.formatDate(tournament.startDate)}<br>
                <strong>Platform:</strong> ${tournament.platform}<br>
                <strong>Rules:</strong> ${tournament.rules}<br>
                <strong>Description:</strong> ${tournament.description}
            `;
            
            this.showNotification("Tournament Details", details, "info");
        }
        
        shareTournament(tournamentId) {
            const tournament = this.state.tournaments.find(t => t.id == tournamentId);
            if (!tournament) return;
            
            if (navigator.share) {
                navigator.share({
                    title: tournament.title,
                    text: `Check out this ${tournament.game} tournament on TourneyHub! Prize: ₮${tournament.prize}`,
                    url: window.location.href
                }).catch(() => {
                    this.copyToClipboard(`${tournament.title} - ₮${tournament.prize} prize pool!`);
                });
            } else {
                this.copyToClipboard(`${tournament.title} - ₮${tournament.prize} prize pool!`);
            }
        }
        
        copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                this.showNotification("Link Copied", "Tournament link copied to clipboard", "success");
            });
        }
        
        viewMatchDetails(matchId) {
            const match = this.state.matches.find(m => m.id == matchId);
            if (!match) return;
            
            this.showNotification("Match Details", `Loading details for ${match.tournament}...`, "info");
        }
        
        logout() {
            if (this.auth) {
                this.auth.signOut().then(() => {
                    window.location.href = 'login.html';
                }).catch(error => {
                    console.error("Logout error:", error);
                    this.showNotification("Logout Failed", "Please try again", "error");
                });
            } else {
                this.showNotification("Logged Out", "Redirecting to login...", "info");
                setTimeout(() => {
                    console.log("Redirecting to login...");
                }, 1500);
            }
        }
        
        showNotification(title, message, type = "info") {
            const toast = document.getElementById('notificationToast');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            const toastIcon = toast?.querySelector('i');
            
            if (!toast || !toastTitle || !toastMessage) return;
            
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            
            const typeColors = {
                success: { bg: 'rgba(0, 255, 157, 0.1)', color: 'var(--neon-green)', icon: 'check-circle' },
                error: { bg: 'rgba(255, 45, 85, 0.1)', color: 'var(--neon-pink)', icon: 'exclamation-circle' },
                warning: { bg: 'rgba(255, 204, 0, 0.1)', color: '#ffcc00', icon: 'exclamation-triangle' },
                info: { bg: 'rgba(0, 243, 255, 0.1)', color: 'var(--neon-blue)', icon: 'info-circle' }
            };
            
            const typeConfig = typeColors[type] || typeColors.info;
            
            if (toastIcon) {
                toastIcon.className = `fas fa-${typeConfig.icon}`;
                toastIcon.parentElement.style.background = typeConfig.bg;
                toastIcon.parentElement.style.color = typeConfig.color;
            }
            
            toast.style.borderLeftColor = typeConfig.color;
            
            toast.classList.add('show');
            
            setTimeout(() => {
                this.hideNotification();
            }, 5000);
        }
        
        hideNotification() {
            const toast = document.getElementById('notificationToast');
            if (toast) {
                toast.classList.remove('show');
            }
        }
        
        checkMobile() {
            const isMobile = window.innerWidth <= 768;
            
            const fab = document.getElementById('fabButton');
            if (fab) {
                fab.style.display = isMobile ? 'flex' : 'none';
            }
            
            const bottomNav = document.querySelector('.bottom-nav');
            if (bottomNav) {
                bottomNav.style.display = isMobile ? 'flex' : 'none';
            }
        }
    }
    
    document.addEventListener('DOMContentLoaded', () => {
        document.documentElement.classList.remove('no-js');
        
        window.dashboard = new GamingDashboard();
        
        document.addEventListener('touchstart', function() {}, {passive: true});
        
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    });
    
    window.addEventListener('error', function(e) {
        console.error('Global error:', e.error);
    });
    
    window.addEventListener('unhandledrejection', function(e) {
        console.error('Unhandled promise rejection:', e.reason);
    });
    </script>
</body>
</html>